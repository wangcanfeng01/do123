<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<head>
    <title>博客-分享你的喜悦</title>
    <script type="text/javascript" th:src="@{/common/meta-icon.js}" src="../static/common/meta-icon.js"></script>
    <link th:href="@{/blog/read.css}" href="../../static/blog/read.css" rel="stylesheet" />
    <script th:src="@{/common/Chart.js/dist/Chart.min.js}" src="../../static/common/Chart.js/dist/Chart.min.js"></script>
    <link th:href="@{/bootstrap/css/bootstrap.min.css}" href="../../static/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <script th:src="@{/jquery/jquery.min.js}" src="../../static/jquery/jquery.min.js"></script>
    <style>
        .box-flex {
            display: -webkit-box; /* OLD - iOS 6-, Safari 3.1-6 */
            display: -moz-box; /* OLD - Firefox 19- (buggy but mostly works) */
            display: -ms-flexbox; /* TWEENER - IE 10 */
            display: -webkit-flex; /* NEW - Chrome */
            display: flex; /* NEW, Spec - Opera 12.1, Firefox 20+ */
            /*width: 100%;*/
        }

        .flex {
            width: 45%;
            margin-right: 5px;
            -webkit-box-flex: 1; /* OLD - iOS 6-, Safari 3.1-6 */
            -moz-box-flex: 1; /* OLD - Firefox 19- */
            /*width: 20%;*/ /*   For old syntax, otherwise collapses. */
            -webkit-flex: 1; /* Chrome */
            -ms-flex: 1; /* IE 10 */
            flex: 1;
        }
    </style>
</head>

<body>
    <script type="text/javascript" th:src="@{/common/header.js}" src="../../static/common/header.js"></script>
    <div class="wcf-content">
        <div id="wrapper">
            <script type="text/javascript" th:src="@{/blog/left.js}" src="../../static/blog/left.js"></script>
            <div th:insert="~{show/read/left::blog-left('center')}"></div>
            <div class="read-management-container">
                <div class="col-md-12">
                    <h4>数据中心</h4>
                </div>
                <div class="col-md-3">
                    <div class="mini-stat clearfix bx-shadow bg-info">
                        <span class="mini-stat-icon"><i class="fa fa-file" aria-hidden="true"></i></span>
                        <div class="mini-stat-info text-right">
                            发布了<span th:text="${statistic.articles}"></span>篇文章
                        </div>
                    </div>
                </div>

                <div class="col-md-3">
                    <div class="mini-stat clearfix bx-shadow bg-success">
                        <span class="mini-stat-icon"><i class="fa fa-font" aria-hidden="true"></i></span>
                        <div class="mini-stat-info text-right">
                            共写了<span th:text="${statistic.words}"></span>个文字
                        </div>
                    </div>
                </div>

                <div class="col-md-3">
                    <div class="mini-stat clearfix bx-shadow bg-danger">
                        <span class="mini-stat-icon"><i class="fa fa-eye" aria-hidden="true"></i></span>
                        <div class="mini-stat-info text-right">
                            获得了<span th:text="${statistic.hits}"></span>次浏览
                        </div>
                    </div>
                </div>

                <div class="col-md-3">
                    <div class="mini-stat clearfix bx-shadow bg-success">
                        <span class="mini-stat-icon"><i class="fa fa-commenting-o" aria-hidden="true"></i></span>
                        <div class="mini-stat-info text-right">
                            收到了<span th:text="${statistic.comments}"></span>条留言
                        </div>
                    </div>
                </div>

                <div class="box-flex col-md-12">
                    <div class="flex">
                        <div class="panel panel-info">
                            <div class="panel-heading">
                                <h4 class="panel-title">文章最多的分类（前7）</h4>
                            </div>
                            <input type="hidden" id="mostCategoryFiles" th:value="${mostCategoryFiles}" />
                            <div class="panel-body">
                                <canvas id="most-category-files" style=" width: 100%; height: 385px;"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="flex">
                        <div class="panel panel-info">
                            <div class="panel-heading">
                                <h4 class="panel-title">最受欢迎的文章（前7）</h4>
                            </div>
                            <input type="hidden" id="mostStars" th:value="${mostStars}" />
                            <div class="panel-body">
                                <canvas id="most-stars" style=" width: 100%; height: 385px;"></canvas>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="box-flex col-md-12">
                    <div class="flex">
                        <div class="panel panel-info">
                            <div class="panel-heading">
                                <h4 class="panel-title">文章字数（前7）</h4>
                            </div>
                            <input type="hidden" id="mostWords" th:value="${mostWords}" />
                            <div class="panel-body">
                                <canvas id="most-words" style=" width: 100%; height: 385px;"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="flex">
                        <div class="panel panel-info">
                            <div class="panel-heading">
                                <h4 class="panel-title">近期发布文章情况</h4>
                            </div>
                            <input type="hidden" id="recentFilesLine" th:value="${recentFilesLine}" />
                            <div class="panel-body">
                                <canvas id="recent-files-line" style=" width: 100%; height: 385px;"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="box-flex col-md-12">
                    <div class="flex">
                        <div class="panel panel-info">
                            <div class="panel-heading">
                                <h4 class="panel-title">近期文章分类情况</h4>
                            </div>
                            <input type="hidden" id="recentCategoryIndex" th:value="${recentCategoryIndex}" />
                            <div class="panel-body">
                                <canvas id="recent-category-index" style=" width: 100%; height: 385px;"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="flex">
                        <div class="panel panel-info">
                            <div class="panel-heading">
                                <h4 class="panel-title">近期文章指数</h4>
                            </div>
                            <input type="hidden" id="recentPictures" th:value="${recentPictures}" />
                            <input type="hidden" id="recentWords" th:value="${recentWords}" />
                            <input type="hidden" id="recentHits" th:value="${recentHits}" />
                            <input type="hidden" id="recentStars" th:value="${recentStars}" />
                            <input type="hidden" id="recentComments" th:value="${recentComments}" />
                            recentPictures
                            <div class="panel-body">
                                <canvas id="recent-file-index" style=" width: 100%; height: 385px;"></canvas>
                            </div>
                        </div>
                    </div>
                </div>


                <div class="col-md-4">
                    <div class="panel panel-info">
                        <div class="panel-heading">
                            <h4 class="panel-title">近期文章</h4>
                        </div>
                        <div class="panel-body">
                            <div th:if="${articles}== null">
                                <div class="alert alert-warning">
                                    近期未发布文章
                                </div>
                            </div>
                            <ul class="list-group">
                                <li class="list-group-item" th:each="article:${articles}">
                                    <span class="badge bg-primary" th:title="${article.hits}+'次浏览'" th:text="${article.hits}"></span>
                                    <a target="_blank" th:href="${utils.articleLink(article.titleSimple)}" th:text="${article.title}"></a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="panel panel-danger">
                        <div class="panel-heading">
                            <h4 class="panel-title">近期留言</h4>
                        </div>
                        <div class="panel-body">
                            <div th:if="${comments}== null">
                                <div class="alert alert-warning">
                                    还没有收到留言.
                                </div>
                            </div>
                            <ul class="list-group" th:if="${comments}!= null">
                                <li class="list-group-item" th:each="comment:${comments}">
                                    <p th:text="${utils.fmtDate(comment.createTime)}+' '+${comment.author}+' 发表评论:'"></p>
                                    <p th:utext="${utils.showComment(comment.text)}"></p>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="panel panel-success">
                        <div class="panel-heading">
                            <h4 class="panel-title">操作日志</h4>
                        </div>
                        <div class="panel-body">
                            <div th:if="${operations}== null">
                                <div class="alert alert-warning">
                                    近期无操作日志
                                </div>
                            </div>
                            <ul class="list-group" th:if="${operations}!= null">
                                <li class="list-group-item" th:each="operation:${operations}">
                                    <p th:text="${operation.ip}+' : '+${utils.fmtDate(operation.createTime)}+'-'
                                +${operation.author}+'-'+${operation.action}"></p>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script>
            function mostCategoryFiles() {
                var data = $('#mostCategoryFiles').val();
                data = data.substring(1, data.length - 1);
                var list = data.split(',');
                var info1 = list[0].split(':');
                var info2 = list[1].split(':');
                var info3 = list[2].split(':');
                var info4 = list[3].split(':');
                var info5 = list[4].split(':');
                var info6 = list[5].split(':');
                var info7 = list[6].split(':');
                var title1 = info1[0], title2 = info2[0], title3 = info3[0], title4 = info4[0], title5 = info5[0],
                    title6 = info6[0], title7 = info7[0];
                var data1 = info1[1], data2 = info2[1], data3 = info3[1], data4 = info4[1], data5 = info5[1],
                    data6 = info6[1], data7 = info7[1];
                new Chart(document.getElementById("most-category-files"), {
                    "type": "bar",
                    "data": {
                        "labels": [title1, title2, title3, title4, title5, title6, title7],
                        "datasets": [{
                            "label": "文章分类图",
                            "data": [data1, data2, data3, data4, data5, data6, data7],
                            "fill": false,
                            "backgroundColor": [
                                "rgba(255, 99, 132, 0.2)",
                                "rgba(255, 159, 64, 0.2)",
                                "rgba(255, 205, 86, 0.2)",
                                "rgba(75, 192, 192, 0.2)",
                                "rgba(54, 162, 235, 0.2)",
                                "rgba(153, 102, 255, 0.2)",
                                "rgba(201, 203, 207, 0.2)"],
                            "borderColor": [
                                "rgb(255, 99, 132)",
                                "rgb(255, 159, 64)",
                                "rgb(255, 205, 86)",
                                "rgb(75, 192, 192)",
                                "rgb(54, 162, 235)",
                                "rgb(153, 102, 255)",
                                "rgb(201, 203, 207)"],
                            "borderWidth": 1
                        }]
                    },
                    "options": { "scales": { "yAxes": [{ "ticks": { "beginAtZero": true } }] } }
                });
            }

            function mostStars() {
                var data = $('#mostStars').val();
                data = data.substring(1, data.length - 1);
                var list = data.split(',');
                var info1 = list[0].split(':');
                var info2 = list[1].split(':');
                var info3 = list[2].split(':');
                var info4 = list[3].split(':');
                var info5 = list[4].split(':');
                var info6 = list[5].split(':');
                var info7 = list[6].split(':');
                var title1 = info1[0], title2 = info2[0], title3 = info3[0], title4 = info4[0], title5 = info5[0],
                    title6 = info6[0], title7 = info7[0];
                var data1 = info1[1], data2 = info2[1], data3 = info3[1], data4 = info4[1], data5 = info5[1],
                    data6 = info6[1], data7 = info7[1];
                new Chart(document.getElementById("most-stars"), {
                    "type": "bar",
                    "data": {
                        "labels": [title1, title2, title3, title4, title5, title6, title7],
                        "datasets": [{
                            "label": "喜欢次数图",
                            "data": [data1, data2, data3, data4, data5, data6, data7],
                            "fill": false,
                            "backgroundColor": [
                                "rgba(255, 99, 132, 0.2)",
                                "rgba(255, 159, 64, 0.2)",
                                "rgba(255, 205, 86, 0.2)",
                                "rgba(75, 192, 192, 0.2)",
                                "rgba(54, 162, 235, 0.2)",
                                "rgba(153, 102, 255, 0.2)",
                                "rgba(201, 203, 207, 0.2)"],
                            "borderColor": [
                                "rgb(255, 99, 132)",
                                "rgb(255, 159, 64)",
                                "rgb(255, 205, 86)",
                                "rgb(75, 192, 192)",
                                "rgb(54, 162, 235)",
                                "rgb(153, 102, 255)",
                                "rgb(201, 203, 207)"],
                            "borderWidth": 1
                        }]
                    },
                    "options": { "scales": { "yAxes": [{ "ticks": { "beginAtZero": true } }] } }
                });
            }

            function mostWords() {
                var data = $('#mostWords').val();
                data = data.substring(1, data.length - 1);
                var list = data.split(',');
                var info1 = list[0].split(':');
                var info2 = list[1].split(':');
                var info3 = list[2].split(':');
                var info4 = list[3].split(':');
                var info5 = list[4].split(':');
                var info6 = list[5].split(':');
                var info7 = list[6].split(':');
                var title1 = info1[0], title2 = info2[0], title3 = info3[0], title4 = info4[0], title5 = info5[0],
                    title6 = info6[0], title7 = info7[0];
                var data1 = info1[1], data2 = info2[1], data3 = info3[1], data4 = info4[1], data5 = info5[1],
                    data6 = info6[1], data7 = info7[1];
                new Chart(document.getElementById("most-words"), {
                    "type": "bar",
                    "data": {
                        "labels": [title1, title2, title3, title4, title5, title6, title7],
                        "datasets": [{
                            "label": "文章字数图",
                            "data": [data1, data2, data3, data4, data5, data6, data7],
                            "fill": false,
                            "backgroundColor": [
                                "rgba(255, 99, 132, 0.2)",
                                "rgba(255, 159, 64, 0.2)",
                                "rgba(255, 205, 86, 0.2)",
                                "rgba(75, 192, 192, 0.2)",
                                "rgba(54, 162, 235, 0.2)",
                                "rgba(153, 102, 255, 0.2)",
                                "rgba(201, 203, 207, 0.2)"],
                            "borderColor": [
                                "rgb(255, 99, 132)",
                                "rgb(255, 159, 64)",
                                "rgb(255, 205, 86)",
                                "rgb(75, 192, 192)",
                                "rgb(54, 162, 235)",
                                "rgb(153, 102, 255)",
                                "rgb(201, 203, 207)"],
                            "borderWidth": 1
                        }]
                    },
                    "options": { "scales": { "yAxes": [{ "ticks": { "beginAtZero": true } }] } }
                });
            }

            function recentFilesLine() {
                var data = $('#recentFilesLine').val();
                data = data.substring(1, data.length - 1);
                var list = data.split(',');
                var info1 = list[0].split(':');
                var info2 = list[1].split(':');
                var info3 = list[2].split(':');
                var info4 = list[3].split(':');
                var info5 = list[4].split(':');
                var info6 = list[5].split(':');
                var info7 = list[6].split(':');
                var month1 = info1[0], month2 = info2[0], month3 = info3[0], month4 = info4[0], month5 = info5[0],
                    month6 = info6[0], month7 = info7[0];
                var data1 = info1[1], data2 = info2[1], data3 = info3[1], data4 = info4[1], data5 = info5[1],
                    data6 = info6[1], data7 = info7[1];
                new Chart(document.getElementById("recent-files-line"), {
                    "type": "line",
                    "data": {
                        "labels": [month1, month2, month3, month4, month5, month6, month7],
                        "datasets": [{
                            "label": "文章发布折线图",
                            "data": [data1, data2, data3, data4, data5, data6, data7],
                            "fill": false,
                            "borderColor": "rgb(75, 192, 192)",
                            "lineTension": 0.1
                        }]
                    },
                    "options": {}
                });
            }

            function recentCategoryIndex() {
                var data = $('#recentCategoryIndex').val();
                data = data.substring(1, data.length - 1);
                var list = data.split(',');
                var info1 = list[0].split(':');
                var info2 = list[1].split(':');
                var info3 = list[2].split(':');
                var info4 = list[3].split(':');
                var info5 = list[4].split(':');
                var info6 = list[5].split(':');
                var info7 = list[6].split(':');
                var category1 = info1[0], category2 = info2[0], category3 = info3[0], category4 = info4[0],
                    category5 = info5[0],
                    category6 = info6[0], category7 = info7[0];
                var data1 = info1[1], data2 = info2[1], data3 = info3[1], data4 = info4[1], data5 = info5[1],
                    data6 = info6[1], data7 = info7[1];
                new Chart(document.getElementById("recent-category-index"), {
                    "type": "doughnut",
                    "data": {
                        "labels": [category1, category2, category3, category4, category5, category6, category7],
                        "datasets": [{
                            "label": "分类环状图",
                            "data": [data1, data2, data3, data4, data5, data6, data7],
                            "backgroundColor": [
                                "rgba(255, 99, 132, 1)",
                                "rgba(255, 159, 64, 1)",
                                "rgba(255, 205, 86, 1)",
                                "rgba(75, 192, 192, 1)",
                                "rgba(54, 162, 235, 1)",
                                "rgba(153, 102, 255, 1)",
                                "rgba(201, 203, 207, 1)"]
                        }]
                    }
                });
            }

            function recentFileIndex() {
                var hits = "点击数";
                var data1 = $('#recentHits').val();
                var stars = "喜欢数";
                var data2 = $('#recentStars').val();
                var pictures = "图片数";
                var data3 = $('#recentPictures').val();
                var comments = "评论数";
                var data4 = $('#recentComments').val();
                var words = "文字数";
                var data5 = $('#recentWords').val();
                new Chart(document.getElementById("recent-file-index"), {
                    "type": "radar",
                    "data": {
                        "labels": [hits, stars, pictures, comments, words],
                        "datasets": [{
                            "label": "近期文章指数",
                            "data": [data1, data2, data3, data4, data5],
                            "fill": true,
                            "backgroundColor": "rgba(255, 99, 132, 0.2)",
                            "borderColor": "rgb(255, 99, 132)",
                            "pointBackgroundColor": "rgb(255, 99, 132)",
                            "pointBorderColor": "#fff",
                            "pointHoverBackgroundColor": "#fff",
                            "pointHoverBorderColor": "rgb(255, 99, 132)"
                        }]
                    },
                    "options": { "elements": { "line": { "tension": 0, "borderWidth": 3 } } }
                });
            }

            mostCategoryFiles();
            mostStars();
            mostWords();
            recentFilesLine();
            recentCategoryIndex();
            recentFileIndex();
        </script>
    </div>
</body>

</html>